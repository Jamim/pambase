#if HAVE_GNOME_KEYRING
auth		optional	pam_gnome_keyring.so
#endif
#if HAVE_TALLY
auth		required	pam_tally.so file=/var/log/faillog onerr=succeed DEBUG
#endif
auth		required	pam_shells.so DEBUG
auth		required	pam_nologin.so DEBUG
auth		include		system-auth
 				
#if HAVE_ACCESS
account		required	pam_access.so DEBUG
#endif
#ifdef HAVE_LOGIN_ACCESS
account		required	pam_login_access.so
#endif
account		include		system-auth
#if HAVE_TALLY
account		required	pam_tally.so file=/var/log/faillog onerr=succeed DEBUG
#endif
 
#if HAVE_GNOME_KEYRING
password	optional	pam_gnome_keyring.so
#endif
password	include		system-auth
 
#if HAVE_SELINUX
session		required	pam_selinux.so close
#endif
#if HAVE_GNOME_KEYRING
session		optional	pam_gnome_keyring.so auto_start
#endif
#if HAVE_ENV
session		required	pam_env.so DEBUG
#endif
session		optional	pam_lastlog.so DEBUG
session		include		system-auth
#if HAVE_SELINUX
session		required	pam_selinux.so multiple open
#endif
// These are optional, so there is no reason to actually put them under
// additional conditionals to get them ignored on FreeBSD.
session		optional	pam_motd.so motd=/etc/motd
session		optional	pam_mail.so
  
